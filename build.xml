<?xml version="1.0" encoding="iso-8859-1"?>
<!--
 * Copyright (c) 2001-2004 atanion GmbH, Germany
 * All rights reserved.
 * $Id$
-->
<project name="tobago" default="compile">
  <property file="build.properties"/>
  <property name="bs.home" location="../build-system"/>
  <import file="${bs.home}/build-basic.xml"/>

  <target name="dist" depends="compile">
    <mkdir dir="${dist}"/>
    <jar jarfile="${dist}/tobago.jar">
      <fileset dir="${build.classes.main}">
        <include name="**/*.class"/>
        <exclude name="com/atanion/tobago/renderkit/html/*/**/*.class"/>
        <exclude name="com/atanion/tobago/renderkit/wml/*/**/*.class"/>
      </fileset>
      <metainf dir="${src.main}/com/atanion/tobago">
        <include name="faces-config.xml"/>
      </metainf>
      <metainf dir="${src.main}/com/atanion/tobago/taglib/component">
        <include name="tobago.tld"/>
      </metainf>
      <metainf dir="${src.main}/com/atanion/tobago/taglib/core">
        <include name="tobago-core.tld"/>
      </metainf>
    </jar>

    <property name="theme" value="${build}/theme" />
    <mkdir dir="${theme}" />

    <macrodef name="zip-theme">
      <attribute name="name"/>
      <sequential>
        <jar jarfile="${theme}/tobago-theme-@{name}.jar">
          <fileset dir="${build.classes.main}">
            <include name="com/atanion/tobago/renderkit/*/@{name}/**/*.class"/>
          </fileset>
        </jar>

        <jar jarfile="${dist}/tobago-theme-@{name}.zip">
          <fileset dir="webapp/tobago">
            <include name="tobago/*/@{name}/**"/>
          </fileset>
          <fileset dir="${theme}">
            <include name="tobago-theme-@{name}.jar"/>
          </fileset>
        </jar>
      </sequential>
    </macrodef>

    <zip-theme name="scarborough"/>
    <zip-theme name="speyside"/>
    <zip-theme name="charlotteville"/>
    <zip-theme name="tui"/>
    <zip-theme name="inexso"/>
    <zip-theme name="sap"/>

  </target>

  <target name="deploy-snapshot" depends="dist, bs:init-project-info, build-basic.deploy-snapshot"
    description="Deploy an artifact into the local repository.">

    <macrodef name="deploy-theme">
      <attribute name="name"/>
      <sequential>
        <default-deploy-artifact offline="true" version="SNAPSHOT"
          source="${dist}/tobago-theme-@{name}.zip" type="zip"
          artifactId="tobago-theme-@{name}"/>
      </sequential>
    </macrodef>

    <deploy-theme name="scarborough"/>
    <deploy-theme name="speyside"/>
    <deploy-theme name="charlotteville"/>
    <deploy-theme name="tui"/>
    <deploy-theme name="inexso"/>
    <deploy-theme name="sap"/>

  </target>

</project>
