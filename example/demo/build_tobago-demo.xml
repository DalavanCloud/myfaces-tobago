<!--
 * Copyright (c) 2001 Atanion GmbH, Germany
 * All rights reserved.
 * $Id: build_tobago-demo.xml 1092 2004-12-08 10:34:09 +0100 (Mi, 08 Dez 2004) lofwyr $
-->
<project>

  <target name="war" depends="compile" >
    <dependency-list baseDir="" property="list.module" dependencyFile="${basedir}/project.xml" delimiter="," purpose="module"/>
    <dependency-list baseDir="" property="list.war" dependencyFile="${basedir}/project.xml" delimiter="," purpose="war"/>

    <mkdir dir="${dist}" />

    <default-fetch-dependencies purpose="module"/>
    <default-fetch-dependencies purpose="war"/>
    <property name="module" value="${build}/module" />
    <mkdir dir="${module}" />
    <unjar dest="${module}">
      <fileset dir="lib" includes="${list.module}"/>
    </unjar>

    <!-- build the war-file -->
    <war warfile="${dist}/${app}.war"
         webxml="webapp/WEB-INF/web.xml">
      <fileset dir="webapp">
        <include name="**"/>
        <exclude name="WEB-INF/**"/>
      </fileset>
      <fileset dir="${module}">
        <include name="tobago/**"/>
        <include name="tobago-module-client/**"/>
      </fileset>
      <lib dir="lib" includes="${list.war}"/>
      <lib dir="${module}">
        <include name="*.jar"/>
      </lib>
      <!-- Application classes -->
      <classes dir="${build.classes.main}">
        <include name="**/*.class" />
      </classes>
      <classes dir="${src.main}">
        <include name="**/*.properties" />
        <include name="**/*.xml" />
      </classes>
      <webinf dir="webapp/WEB-INF">
        <include name="**"/>
        <exclude name="web.xml"/>
      </webinf>
    </war>
  </target>

</project>
